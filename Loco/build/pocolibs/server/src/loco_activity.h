/* --- Generated by genom 2.99.29. Do not edit -------------------------- */

#ifndef H_LOCO_ACTIVITY
#define H_LOCO_ACTIVITY

#include "typecopy.h"
#include "loco_parameters.h"

/* forward declaration */
struct genom_component_data;

enum genom_activity_status {
  ACT_VOID,	/* nothing */
  ACT_INIT,	/* in control task codels */
  ACT_RUN,	/* managed by exec task, running */
  ACT_STOP,	/* managed by exec task, stopping */
  ACT_ETHER	/* result available for control task */
};

struct genom_activity {
  int sid;	/* service number, -1 for permanent activity */
  int aid;	/* activity number */
  int rid;	/* csLib request id */

  enum genom_activity_status status;	/* current phase */
  int start, stop, pause;		/* status change request */
  genom_event state;			/* current FSM state */

  void *exdetail;			/* exception info, if any */
  const char *interruptedby;
};


/* === Service activity ==================================================== */


/* --- abort_activity --------------------------------------------------- */

/* activity data */
struct genom_loco_abort_activity_activity {
  struct genom_activity h;
  struct genom_loco_abort_activity_input in;
  struct genom_loco_abort_activity_output out;
};

/* input/output initializer */
static __inline__ void
genom_tinit_loco_abort_activity_activity(
  struct genom_loco_abort_activity_activity *a)
{
  genom_tinit_unsigned_long(
    &(a->in.activity));
}

/* input/output finalizer */
static __inline__ void
genom_tfini_loco_abort_activity_activity(
  struct genom_loco_abort_activity_activity *a)
{
  genom_tfini_unsigned_long(
    &(a->in.activity));
}


/* --- connect_port ----------------------------------------------------- */

/* activity data */
struct genom_loco_connect_port_activity {
  struct genom_activity h;
  struct genom_loco_connect_port_input in;
  struct genom_loco_connect_port_output out;
};

/* input/output initializer */
static __inline__ void
genom_tinit_loco_connect_port_activity(
  struct genom_loco_connect_port_activity *a)
{
  genom_tinit_string128(
    a->in.local);
  genom_tinit_string128(
    a->in.remote);
}

/* input/output finalizer */
static __inline__ void
genom_tfini_loco_connect_port_activity(
  struct genom_loco_connect_port_activity *a)
{
  genom_tfini_string128(
    a->in.local);
  genom_tfini_string128(
    a->in.remote);
}


/* --- connect_service -------------------------------------------------- */

/* activity data */
struct genom_loco_connect_service_activity {
  struct genom_activity h;
  struct genom_loco_connect_service_input in;
  struct genom_loco_connect_service_output out;
};

/* input/output initializer */
static __inline__ void
genom_tinit_loco_connect_service_activity(
  struct genom_loco_connect_service_activity *a)
{
  genom_tinit_string128(
    a->in.local);
  genom_tinit_string128(
    a->in.remote);
}

/* input/output finalizer */
static __inline__ void
genom_tfini_loco_connect_service_activity(
  struct genom_loco_connect_service_activity *a)
{
  genom_tfini_string128(
    a->in.local);
  genom_tfini_string128(
    a->in.remote);
}


/* --- kill ------------------------------------------------------------- */

/* activity data */
struct genom_loco_kill_activity {
  struct genom_activity h;
  struct genom_loco_kill_input in;
  struct genom_loco_kill_output out;
};

/* input/output initializer */
static __inline__ void
genom_tinit_loco_kill_activity(
  struct genom_loco_kill_activity *a)
{
  (void)a; /* fix -Wunused-parameter */
}

/* input/output finalizer */
static __inline__ void
genom_tfini_loco_kill_activity(
  struct genom_loco_kill_activity *a)
{
  (void)a; /* fix -Wunused-parameter */
}


/* --- GetCurrentPosition ----------------------------------------------- */

/* activity data */
struct genom_loco_GetCurrentPosition_activity {
  struct genom_activity h;
  struct genom_loco_GetCurrentPosition_input in;
  struct genom_loco_GetCurrentPosition_output out;
};

/* input/output initializer */
static __inline__ void
genom_tinit_loco_GetCurrentPosition_activity(
  struct genom_loco_GetCurrentPosition_activity *a)
{
  genom_tinit_t_camera_robot(
    &(a->out.position));
}

/* input/output finalizer */
static __inline__ void
genom_tfini_loco_GetCurrentPosition_activity(
  struct genom_loco_GetCurrentPosition_activity *a)
{
  genom_tfini_t_camera_robot(
    &(a->out.position));
}


/* --- GetCurrentBattery ------------------------------------------------ */

/* activity data */
struct genom_loco_GetCurrentBattery_activity {
  struct genom_activity h;
  struct genom_loco_GetCurrentBattery_input in;
  struct genom_loco_GetCurrentBattery_output out;
};

/* input/output initializer */
static __inline__ void
genom_tinit_loco_GetCurrentBattery_activity(
  struct genom_loco_GetCurrentBattery_activity *a)
{
  genom_tinit_t_loco_data(
    &(a->out.batterie));
}

/* input/output finalizer */
static __inline__ void
genom_tfini_loco_GetCurrentBattery_activity(
  struct genom_loco_GetCurrentBattery_activity *a)
{
  genom_tfini_t_loco_data(
    &(a->out.batterie));
}


/* --- GetCurrentMap ---------------------------------------------------- */

/* activity data */
struct genom_loco_GetCurrentMap_activity {
  struct genom_activity h;
  struct genom_loco_GetCurrentMap_input in;
  struct genom_loco_GetCurrentMap_output out;
};

/* input/output initializer */
static __inline__ void
genom_tinit_loco_GetCurrentMap_activity(
  struct genom_loco_GetCurrentMap_activity *a)
{
  genom_tinit_t_camera_map(
    &(a->out.image));
}

/* input/output finalizer */
static __inline__ void
genom_tfini_loco_GetCurrentMap_activity(
  struct genom_loco_GetCurrentMap_activity *a)
{
  genom_tfini_t_camera_map(
    &(a->out.image));
}


/* --- GetCurrentArena -------------------------------------------------- */

/* activity data */
struct genom_loco_GetCurrentArena_activity {
  struct genom_activity h;
  struct genom_loco_GetCurrentArena_input in;
  struct genom_loco_GetCurrentArena_output out;
};

/* input/output initializer */
static __inline__ void
genom_tinit_loco_GetCurrentArena_activity(
  struct genom_loco_GetCurrentArena_activity *a)
{
  genom_tinit_t_camera_arena(
    &(a->out.arene));
}

/* input/output finalizer */
static __inline__ void
genom_tfini_loco_GetCurrentArena_activity(
  struct genom_loco_GetCurrentArena_activity *a)
{
  genom_tfini_t_camera_arena(
    &(a->out.arene));
}


/* --- MoveStop --------------------------------------------------------- */

/* activity data */
struct genom_loco_MoveStop_activity {
  struct genom_activity h;
  struct genom_loco_MoveStop_input in;
  struct genom_loco_MoveStop_output out;
};

/* input/output initializer */
static __inline__ void
genom_tinit_loco_MoveStop_activity(
  struct genom_loco_MoveStop_activity *a)
{
  (void)a; /* fix -Wunused-parameter */
}

/* input/output finalizer */
static __inline__ void
genom_tfini_loco_MoveStop_activity(
  struct genom_loco_MoveStop_activity *a)
{
  (void)a; /* fix -Wunused-parameter */
}


/* --- BattStop --------------------------------------------------------- */

/* activity data */
struct genom_loco_BattStop_activity {
  struct genom_activity h;
  struct genom_loco_BattStop_input in;
  struct genom_loco_BattStop_output out;
};

/* input/output initializer */
static __inline__ void
genom_tinit_loco_BattStop_activity(
  struct genom_loco_BattStop_activity *a)
{
  (void)a; /* fix -Wunused-parameter */
}

/* input/output finalizer */
static __inline__ void
genom_tfini_loco_BattStop_activity(
  struct genom_loco_BattStop_activity *a)
{
  (void)a; /* fix -Wunused-parameter */
}


/* --- StartMove -------------------------------------------------------- */

/* activity data */
struct genom_loco_StartMove_activity {
  struct genom_activity h;
  struct genom_loco_StartMove_input in;
  struct genom_loco_StartMove_output out;
};

/* input/output initializer */
static __inline__ void
genom_tinit_loco_StartMove_activity(
  struct genom_loco_StartMove_activity *a)
{
  (void)a; /* fix -Wunused-parameter */
}

/* input/output finalizer */
static __inline__ void
genom_tfini_loco_StartMove_activity(
  struct genom_loco_StartMove_activity *a)
{
  (void)a; /* fix -Wunused-parameter */
}


/* --- StartBatt -------------------------------------------------------- */

/* activity data */
struct genom_loco_StartBatt_activity {
  struct genom_activity h;
  struct genom_loco_StartBatt_input in;
  struct genom_loco_StartBatt_output out;
};

/* input/output initializer */
static __inline__ void
genom_tinit_loco_StartBatt_activity(
  struct genom_loco_StartBatt_activity *a)
{
  (void)a; /* fix -Wunused-parameter */
}

/* input/output finalizer */
static __inline__ void
genom_tfini_loco_StartBatt_activity(
  struct genom_loco_StartBatt_activity *a)
{
  (void)a; /* fix -Wunused-parameter */
}



/* === Activities ========================================================== */

union genom_any_activity {
  struct genom_activity any;
  struct genom_loco_abort_activity_activity s_abort_activity;
  struct genom_loco_connect_port_activity s_connect_port;
  struct genom_loco_connect_service_activity s_connect_service;
  struct genom_loco_kill_activity s_kill;
  struct genom_loco_GetCurrentPosition_activity s_GetCurrentPosition;
  struct genom_loco_GetCurrentBattery_activity s_GetCurrentBattery;
  struct genom_loco_GetCurrentMap_activity s_GetCurrentMap;
  struct genom_loco_GetCurrentArena_activity s_GetCurrentArena;
  struct genom_loco_MoveStop_activity s_MoveStop;
  struct genom_loco_BattStop_activity s_BattStop;
  struct genom_loco_StartMove_activity s_StartMove;
  struct genom_loco_StartBatt_activity s_StartBatt;
};

struct genom_activities {
  union genom_any_activity a[16];
};

static inline size_t
genom_max_activities(void) {
  struct genom_activities *a;
  return sizeof(a->a)/sizeof(a->a[0]);
}

int	genom_loco_activity_alloc(struct genom_activities *activities);
void	genom_loco_activity_report(struct genom_component_data *self,
		struct genom_activity *a);
int	genom_loco_activity_encodex(char *buffer, int size, char *dst,
                int maxsize);
int	genom_loco_interrupt_reqd(struct genom_component_data *self,
		struct genom_activity *a);

#endif /* H_LOCO_ACTIVITY */
